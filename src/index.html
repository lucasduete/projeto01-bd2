<!DOCTYPE html>
<html data-ng-app="projetoBD">
	<head>
		<title>Home</title>
		<meta charset="UTF-8">
	</head>

	<style>
	      /* Always set the map height explicitly to define the size of the div
	       * element that contains the map. */
	      #map {
	        height: 60%;
	        width: 70%;
	        margin-left: 10%;
	      }
	      /* Optional: Makes the sample page fill the window. */
	      html, body {
	        height: 100%;
	        margin: 0;
	        padding: 0;
	      }
    </style>

	<body ng-controller="LocalController as Local">

		<button ng-click="Local.initMap()">Teste</button>

		<div id="map"></div>

		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.7/angular.min.js"></script>
    	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA26N7U2JuMCMfu1u4IJKGtSP7286dE45Q&callback=" + {{Local.initMap()}} async defer></script>
		<script type="text/javascript">
			angular.module('projetoBD', [])
				.controller('LocalController', LocalController);

				function LocalController() {
					var vm = this;

					vm.chave =  "AIzaSyA26N7U2JuMCMfu1u4IJKGtSP7286dE45Q";

					vm.initMap = initMap;
					var map;
		      		function initMap() {
		        		map = new google.maps.Map(document.getElementById('map'), {
		          		center: {lat: -6.887860, lng: -38.559366},
		          		zoom: 16
		        		});
		      		 var infoWindow = new google.maps.InfoWindow({map: map});

			        // Tenta Utilizar o Serviço do HTML5 de Geolocalização
			        if (navigator.geolocation) {
			          navigator.geolocation.getCurrentPosition(function(position) {
			            var pos = {
			              lat: position.coords.latitude,
			              lng: position.coords.longitude
			            };

			            infoWindow.setPosition(pos);
			            infoWindow.setContent('Você Está Aqui! xD');
			            map.setCenter(pos);
			          }, function() {
			            handleLocationError(true, infoWindow, map.getCenter());
			          });
			        } else {
			          // Navegador Não Suporta Serviço de Geolocalização
			          handleLocationError(false, infoWindow, map.getCenter());
			        }
			      }

			      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
			        infoWindow.setPosition(pos);
			        infoWindow.setContent(browserHasGeolocation ?
			                              'Não Foi Possivel Determinar Sua Localização :(' :
			                              'Seu Navegador Não Suporta o Serviço de Localização ;(');
			      }


				};

				
		</script>
	</body>
</html>